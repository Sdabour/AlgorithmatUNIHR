@using SharpVision.CRM.CRMBusiness;
@using SharpVision.SystemBase
@using SharpVision.UMS.UMSBusiness
@using System.Web.Script.Serialization
@using SharpVision.Base.BaseBusiness;
@using System.Linq;

@{
    ViewBag.Title = "UnitClose";
    Layout = Url.Content("~/Views/Shared/_LayoutYoussef.cshtml");
}

<h2>UnitClose</h2>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href=@Url.Content("~/Content/UnitStyle.css") rel="stylesheet" />
<link href="~/Content/Modal.css" rel="stylesheet" />
<script src="~/Scripts/JqueryLatest.js"></script>
<script src="~/Scripts/bootstrap.js"></script>

<body dir="rtl">

    @{
        bool _UMSCloseOpenAuthorised = true;
        bool _SelectEnabled = true;
        string strCheck = "";
    }

    <script src="~/Scripts/ControlScript.js"></script>
    <script type="text/javascript">
        function CheckFormValidation() {


            if (document.getElementById("txtCloseReason") == null || document.getElementById("txtCloseReason").value == "") {
                alert("فضلا حدد سبب الغلق");
                return false;
            }
            if (!document.getElementById("chkIsPermanent").checked &&
                (document.getElementById("txtPeriod") == null || document.getElementById("txtPeriod").value == "")) {
                alert("فضلا حدد ما اذا كان الغلق دائم او حدد المدة");
                return false;
            }
            return true;
        }

        $(document).ready(function () {
            var objUnitmodal = document.getElementById("myUnitModal");

            // Get the button that opens the modal
            var objUnitbtn = document.getElementById("myUnitBtn");

            // Get the <span> element that closes the modal
            var objUnitspan = document.getElementById("UnitClose");

            // When the user clicks on the button, open the modal
            objUnitbtn.onclick = function () {
                objUnitmodal.style.display = "block";
                return false;
            }

            // When the user clicks on <span> (x), close the modal
            objUnitspan.onclick = function () {
                objUnitmodal.style.display = "none";


            }




        });
    </script>
    <!--webbot bot="SaveResults" U-File="E:\Work\SharpvisionLastVersion\HTMLTuturial\_private\form_results.csv" S-Format="TEXT/CSV" S-Label-Fields="TRUE" -->
    <table>
        @using (Html.BeginForm("CloseUnit", "Unit", FormMethod.Post, new { onsubmit = "return CheckFormValidation()" }))
        {
            <tr>
                <td>



                    <div style=" height:65px">
                        &nbsp;
                        <table>
                            <tr>
                                <td width="20">&#1583;&#1575;&#1574;&#1605;</td>
                                <td><label><input type="checkbox" id="chkIsPermanent" name="chkIsPermanent" title="&#1583;&#1575;&#1574;&#1605;" /><span></span></label></td>
                                <td>&nbsp;</td>
                            </tr>
                            <tr>
                                <td>
                                    &#1594;&#1604;&#1602; &#1604;&#1605;&#1583;&#1577;
                                </td>
                                <td>
                                    <input type="text" name="txtPeriod" id="txtPeriod" size="10" />
                                </td>
                                <td>
                                    <select name="cmbPeriod" id="cmbPeriod">
                                        <option selected value="0">&#1583;&#1602;&#1610;&#1602;&#1577;</option>
                                        <option value="1">&#1587;&#1575;&#1593;&#1577;</option>
                                        <option value="2">&#1610;&#1608;&#1605;</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>&#1587;&#1576;&#1576; &#1575;&#1604;&#1594;&#1604;&#1602;</td>
                                <td><input type="text" name="txtCloseReason" id="txtCloseReason"></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td><input type="submit" id="btnClose" value="غلق" /></td>
                            </tr>
                            <tr>
                                <td> <button type="button" id="myUnitBtn">الوحدات</button></td>
                            </tr>
                        </table>

                    </div>

                </td>

            </tr>
           
            <tr>
                <td>
                    <div>

                        @{ string strModalDisplay = ViewBag.UnitCol != null && ViewBag.UnitCol.Count > 0 ? "block" : "none";}
                        <div id="myUnitModal" class="modal" tabindex="-1" style="display:@strModalDisplay;">

                            <!-- Modal content -->
                            <div class="modal-content">
                                <span id="UnitClose" class="close">&times;</span>
                                <table>
                                    <tr>
                                        <td id="tdSearchResult">
                                            <div dir="rtl" style="overflow: scroll;max-height:500px ; width: 100%;">

                                                @if (ViewBag.UnitCol != null)
                                                {


                                                    <table>
                                                        <tr>
                                                            <td>
                                                            </td>
                                                            @if (_UMSCloseOpenAuthorised)
                                                            {
                                                                <td>
                                                                </td>
                                                            }
                                                        </tr>
                                                    </table>
                                                    <table>
                                                        <thead>
                                                            <tr>
                                                                @if (_SelectEnabled)
                                                                {
                                                                    <th>
                                                                        <label><input type="checkbox" id="chkSelectAllUnit" onchange="ChkChanged('chkSelectAllUnit', 'chkUnit', 'UnitCheckCol')" /><span></span></label>

                                                                    </th>
                                                                }
                                                                <th align="center">&#1575;&#1604;&#1603;&#1608;&#1583;</th>
                                                                <th align="center">&#1575;&#1604;&#1606;&#1608;&#1593;</th>
                                                                <th align="center">&#1575;&#1604;&#1605;&#1588;&#1585;&#1608;&#1593;</th>
                                                                <th align="center">&#1575;&#1604;&#1576;&#1585;&#1580;</th>
                                                                <th align="center">&#1575;&#1604;&#1583;&#1608;&#1585;</th>
                                                                <th align="center">&#1575;&#1604;&#1581;&#1575;&#1604;&#1577;</th>
                                                                <th align="center">&#1575;&#1604;&#1605;&#1587;&#1575;&#1581;&#1577;</th>
                                                                <th align="center">&#1575;&#1604;&#1593;&#1605;&#1610;&#1604;</th>
                                                                <th align="center">&#1575;&#1604;&#1605;&#1604;&#1581;&#1602;&#1575;&#1578;</th>
                                                                <th align="center">&#1605;&#1604;&#1575;&#1581;&#1592;&#1575;&#1578;</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>

                                                            @foreach (UnitBiz objBiz in ViewBag.UnitCol)
                                                            {
                                                                <tr>
                                                                    @if (_SelectEnabled)
                                                                    {
                                                                        strCheck = "chkUnit" + objBiz.ID;
                                                                        <td><label><input type="checkbox" name="@strCheck" id="@strCheck" /><span></span></label></td>
                                                                    }
                                                                    <td align="center">@objBiz.FullName</td>
                                                                    <td>@objBiz.UsageTypeBiz.Name</td>
                                                                    <td>@objBiz.TowerBiz.ProjectBiz.Name</td>
                                                                    <td>@objBiz.TowerBiz.Name</td>
                                                                    <td>@objBiz.FloorBiz.Name</td>
                                                                    <td>@objBiz.StatusWithoutCustomerStr</td>
                                                                    <td>@objBiz.Survey</td>
                                                                    <td>@objBiz.CustomerStr</td>
                                                                    <td>@objBiz.PeripheralFullName</td>
                                                                    <td>@objBiz.Desc</td>
                                                                </tr>
                                                            }

                                                        </tbody>
                                                    </table>
                                                    <input type="hidden" id="UnitCheckCol" name="UnitCheckCol" value="@ViewBag.UnitIDs" />


                                                }
                                            </div>
                                        </td>
                                    </tr>
                                </table>

                            </div>

                        </div>





                    </div>


                </td>
            </tr>

        }
    </table>


</body>
